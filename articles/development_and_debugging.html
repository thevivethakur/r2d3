<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Development and Debugging • r2d3</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<script src="../extra.js"></script><meta property="og:title" content="Development and Debugging">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">r2d3</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Using</li>
    <li>
      <a href="../articles/data_conversion.html">R to D3 Data Conversion</a>
    </li>
    <li>
      <a href="../articles/visualization_options.html">D3 Visualization Options</a>
    </li>
    <li>
      <a href="../articles/development_and_debugging.html">Development and Debugging</a>
    </li>
    <li>
      <a href="../articles/publishing.html">Publishing D3 Visualizations</a>
    </li>
    <li class="divider">
    </li>
<li class="dropdown-header">Advanced</li>
    <li>
      <a href="../articles/shiny.html">Using r2d3 with Shiny</a>
    </li>
    <li>
      <a href="../articles/dependencies.html">CSS and JavaScript Dependencies </a>
    </li>
    <li>
      <a href="../articles/advanced_rendering.html">Advanced Rendering with Callbacks</a>
    </li>
    <li>
      <a href="../articles/package_development.html">Package Development</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/learning_d3.html">Learning D3</a>
</li>
<li>
  <a href="../articles/gallery.html">Gallery</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rstudio/r2d3/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Development and Debugging</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rstudio/r2d3/blob/main/vignettes/development_and_debugging.Rmd" class="external-link"><code>vignettes/development_and_debugging.Rmd</code></a></small>
      <div class="hidden name"><code>development_and_debugging.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This article describes recommend workflow for developing D3
visualizations, including:</p>
<ol style="list-style-type: decimal">
<li><p>Using integrated tools for <strong>r2d3</strong> within RStudio
to preview visualizations; and</p></li>
<li><p>Using browser debugging tools to pinpoint errors in your
code.</p></li>
</ol>
<p>Note that the development tools described above are only fully
supported within the <a href="https://rstudio.com/products/rstudio/download/" class="external-link">RStudio v1.2
preview release</a> (as opposed to the current stable release) so you
should download the daily build before trying these features out.</p>
</div>
<div class="section level2">
<h2 id="rstudio-preview">RStudio Preview<a class="anchor" aria-label="anchor" href="#rstudio-preview"></a>
</h2>
<p>The <a href="https://rstudio.com/products/rstudio/download/" class="external-link">RStudio
v1.2 preview release</a> includes support for previewing D3 scripts as
you write them. To try this out, create a D3 script using the new file
menu:</p>
<p><img src="images%2Fnew_script.png" class="screenshot" width="600/"></p>
<p>A simple template for a D3 script (the barchart.js example shown
above) is provided by default. You can use the <strong>Preview</strong>
command (Ctrl+Shift+Enter) to render the visualization:</p>
<p><img src="images%2Frstudio_preview.png" class="screenshot" width="600/"></p>
<p>You might wonder where the data comes from for the preview. Note that
there is a special comment at the top of the D3 script:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co">// !preview r2d3 data=c(0.3, 0.6, 0.8, 0.95, 0.40, 0.20)</span></span></code></pre></div>
<p>This comment enables you to specify the data (along with any other
arguments to the <code><a href="../reference/r2d3.html">r2d3()</a></code> function) to use for the
preview.</p>
<div class="section level3">
<h3 id="error-navigation">Error Navigation<a class="anchor" aria-label="anchor" href="#error-navigation"></a>
</h3>
<p>If an error occurs while rendering a D3 visualization using preview
mode then the error will be displayed in the Viewer pane:</p>
<p><img src="images%2Ferror_debugging.png" class="screenshot" width="600/"></p>
<p>The source pane will also be navigated to the location in your script
where the error occurred.</p>
</div>
<div class="section level3">
<h3 id="viewer-options">Viewer Options<a class="anchor" aria-label="anchor" href="#viewer-options"></a>
</h3>
<p>The <code>viewer</code> argument to the <code><a href="../reference/r2d3.html">r2d3()</a></code> function
enables you to customize how D3 visualizations are viewed when printed
from within the RStudio console. The following options are
available:</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Option</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>viewer = "internal"</code></td>
<td>(Default). Display within the RStudio Viewer pane.</td>
</tr>
<tr class="even">
<td><code>viewer = "external"</code></td>
<td>Display within an external RStudio Viewer window.</td>
</tr>
<tr class="odd">
<td><code>viewer = "browser"</code></td>
<td>Display within an external web browser (e.g. Chrome).</td>
</tr>
</tbody>
</table>
<p>The “external” option is useful if your visualization requires more
space than an RStudio pane affords. The “browser” option is useful if
you need access to browser debugging tools during development.</p>
<p>Here’s an example of adding the <code>viewer</code> argument to the
preview comment at the top of a D3 script:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co">// !preview r2d3 data=c(0.3, 0.6, 0.8, 0.95, 0.40, 0.20), viewer="external"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="console-logging">Console Logging<a class="anchor" aria-label="anchor" href="#console-logging"></a>
</h2>
<p>When troubleshooting a visualization it is also often useful to print
diagnostics to the JavaScript console. This is usually accomplished by
calling <code>console.log()</code> with a message that can help you
troubleshoot the problem at hand.</p>
<p>For instance, the following script does not trigger any runtime
errors but also does not render anything at all:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co">// !preview r2d3 data=c(0.3, 0.6, 0.8, 0.95, 0.40, 0.20)</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="kw">var</span> barHeight <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(height <span class="op">/</span> data<span class="op">.</span><span class="at">length</span>)<span class="op">;</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'rect'</span>)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="op">.</span><span class="fu">data</span>(data)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  <span class="op">.</span><span class="fu">enter</span>()<span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> <span class="kw">function</span>(d) { <span class="cf">return</span> d<span class="op">;</span> })</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> barHeight)</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> <span class="kw">function</span>(d<span class="op">,</span> i) { <span class="cf">return</span> i <span class="op">*</span> barHeight<span class="op">;</span> })</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'steelblue'</span>)<span class="op">;</span></span></code></pre></div>
<p>In this case, we think the problem might be with the
<code>width</code> so we print this value to the console as follows:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co">// !preview r2d3 data=c(0.3, 0.6, 0.8, 0.95, 0.40, 0.20)</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="kw">var</span> barHeight <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(height <span class="op">/</span> data<span class="op">.</span><span class="at">length</span>)<span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>svg<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">'rect'</span>)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="op">.</span><span class="fu">data</span>(data)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="op">.</span><span class="fu">enter</span>()<span class="op">.</span><span class="fu">append</span>(<span class="st">'rect'</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'width'</span><span class="op">,</span> <span class="kw">function</span>(d) {</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>      <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">"The width has value "</span> <span class="op">+</span> d)</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>      <span class="cf">return</span> d <span class="op">*</span> width <span class="op">*</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>    })</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'height'</span><span class="op">,</span> barHeight)</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'y'</span><span class="op">,</span> <span class="kw">function</span>(d<span class="op">,</span> i) { <span class="cf">return</span> i <span class="op">*</span> barHeight<span class="op">;</span> })</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">'fill'</span><span class="op">,</span> <span class="st">'steelblue'</span>)<span class="op">;</span></span></code></pre></div>
<p><strong>r2d3</strong> renders renders the JavaScript console output
directly into the visualization. For this example, this will show that
the <code>width</code> is <code>0.2</code>, which is too small to be
visible:</p>
<p><img src="images%2Fconsole_logging.png" class="illustration" width="600/"></p>
</div>
<div class="section level2">
<h2 id="debugging">Debugging<a class="anchor" aria-label="anchor" href="#debugging"></a>
</h2>
<p>If you need to debug errors or other unexpected behavior in your D3
script, you can use the <em>Show in new window</em> window command
within the RStudio Viewer to show the visualization in an external web
browser:</p>
<p><img src="images%2Fshow_in_new_window.png" class="illustration" width="600/"></p>
<p>It’s also possible to add the <code>viewer="browser"</code> option to
your <code>!preview</code> comment at the top of the file to skip the
RStudio Viewer and route the visualization directly to an external
browser:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode js"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co">// !preview r2d3 data=c(0.3, 0.6, 0.8, 0.95, 0.40, 0.20), viewer="browser"</span></span></code></pre></div>
<p>Once you’ve opened the visualization you can use your browser
<strong>Developer Tools</strong> to do additional debugging (typically
you’ll need to reload the page after you’ve opened the developer tools
pane in order to reproduce the error):</p>
<p><img src="images%2Fbrowser_developer_tools.png" class="screenshot" width="600/"></p>
<p>Your original D3 script and dependencies are available as a
<code>r2d3-script-###</code> script which can be used to set breakpoints
or inspect errors in detail:</p>
<p><img src="images%2Fbrowser_debugging_entry.png" class="illustration" width="380/"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nick Strayer, Javier Luraschi, JJ Allaire.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
